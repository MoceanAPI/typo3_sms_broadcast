<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
    <h1>SMS Transaction History</h1>
    <div style="float: right;">
        <f:form action="search" method="post" id="searchTransaction">
            <core:icon identifier="actions-search" />
            <f:form.textfield name="searchValue" />
            <f:form.submit value="Search" />
        </f:form>
    </div>
    <br/>
    <div class='panel panel-default panel-space'>
        <div class='table-fit'>
            <table class='table table-striped table-hover' id='data'>
                <thead>
                    <tr>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.sender')}
                        </th>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.datetime')}
                        </th>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.message')}
                        </th>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.recipient')}
                        </th>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.response')}
                        </th>
                        <th>{f:translate(key:
                            'LLL:EXT:mocean_api_broadcast/Resources/Private/Language/locallang_db.xlf:tx_moceanapibroadcast_domain_model_history.status')}
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <f:for each="{history}" as="h">
                        <tr>
                            <td>{h.sender}</td>
                            <td><f:format.date format="H:i:s d.m.Y">{h.datetime}</f:format.date></td>
                            <td>{h.message}</td>
                            <td>{h.recipient}</td>
                            <td>{h.response}</td>
                            <td>{h.status}</td>
                        </tr>
                    </f:for>
                </tbody>
            </table>
        </div>
    </div>
    <div style="float: right;">
        <f:link.action action="export">
            <f:form.button><core:icon identifier="actions-download" /> Export Log</f:form.button>
        </f:link.action>
    </div>
    
    <script>
        $(document).ready(function(){
        $('#data').after('<div id="nav" style="padding: 5px; background : #f0ecec"></div>');
        var rowsShown = 10
        var rowsTotal = $('#data tbody tr').length;
        var numPages = rowsTotal/rowsShown;
        for(i = 0; i < numPages; i++) {
            var pageNum = i + 1;
            $('#nav').append('<span style="padding: 5px"><a href="#" rel="' + i + '">'+pageNum+'</a></span> ');
        }
        $('#data tbody tr').hide();
        $('#data tbody tr').slice(0, rowsShown).show();
        $('#nav a:first').addClass('active');
        $('#nav a').bind('click', function(){

            $('#nav a').removeClass('active');
            $(this).addClass('active');
            var currPage = $(this).attr('rel');
            var startItem = currPage * rowsShown;
            var endItem = startItem + rowsShown;
            $('#data tbody tr').css('opacity','0.0').hide().slice(startItem, endItem).
                    css('display','table-row').animate({opacity:1}, 300);
        });
    });
    </script>
    
</html>

